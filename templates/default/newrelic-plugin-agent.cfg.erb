###########################################
# Generated by Chef for <%= node['fqdn'] %>
###########################################
%YAML 1.2
---
Application:
  license_key: <%= @license_key %>
  wake_interval: <%= @wake_interval %>
  <% unless @proxy.nil? %>
  proxy: <%= @proxy %>
  <% end %>
  

  <% if node['newrelic_meetme_plugin']['config'].attribute?('postgresql') -%>
  postgresql:
    <% @config = node['newrelic_meetme_plugin']['config']['postgresql'].dup -%>
    <% @config.sort.each do |key, value| -%>
    <% next if value.nil? -%>
    <%= key %>: <%=value%>
    <% end -%>
  <% end -%>
  
  <% if node['newrelic_meetme_plugin']['config'].attribute?('memcached') -%>
  memcached:
    <% @config = node['newrelic_meetme_plugin']['config']['memcached'].dup -%>
    <% @config.sort.each do |key, value| -%>
    <% next if value.nil? -%>
    <%= key %>: <%=value%>
    <% end -%>
  <% end -%>
  
  <% if node['newrelic_meetme_plugin']['config'].attribute?('redis') -%>
  redis:
    <% @config = node['newrelic_meetme_plugin']['config']['redis'].dup -%>
    <% @config.sort.each do |key, value| -%>
    <% next if value.nil? -%>
    <%= key %>: <%=value%>
    <% end -%>
  <% end -%>
  
  <% if node['newrelic_meetme_plugin']['config'].attribute?('nginx') -%>
  nginx:
    <% @config = node['newrelic_meetme_plugin']['config']['nginx'].dup -%>
    <% @config.sort.each do |key, value| -%>
    <% next if value.nil? -%>
    <%= key %>: <%=value%>
    <% end -%>
  <% end -%>

  <% if node['newrelic_meetme_plugin']['config'].attribute?('apache') -%>
  apache_httpd:
    <% @config = node['newrelic_meetme_plugin']['config']['apache'].dup -%>
    <% @config.sort.each do |key, value| -%>
    <% next if value.nil? -%>
    <%= key %>: <%=value%>
    <% end -%>
  <% end -%>

  <% if node['newrelic_meetme_plugin']['config'].attribute?('elasticsearch') -%>
  elasticsearch:
    <% @config = node['newrelic_meetme_plugin']['config']['elasticsearch'].dup -%>
    <% @config.sort.each do |key, value| -%>
    <% next if value.nil? -%>
    <%= key %>: <%=value%>
    <% end -%>
  <% end -%>    


Daemon:
  user: <%= @user %>
  pidfile: <%= @pid_file %>

Logging:
  formatters:
    verbose:
      format: '%(levelname) -10s %(asctime)s %(process)-6d %(processName) -15s %(threadName)-10s %(name) -45s %(funcName) -25s L%(lineno)-6d: %(message)s'
  handlers:
    file:
      class : logging.handlers.RotatingFileHandler
      formatter: verbose
      filename: <%= @log_file %>
      maxBytes: 10485760
      backupCount: 3
  loggers:
    newrelic_plugin_agent:
      level: INFO
      propagate: True
      handlers: [console, file]
    requests:
      level: ERROR
      propagate: True
      handlers: [console, file]